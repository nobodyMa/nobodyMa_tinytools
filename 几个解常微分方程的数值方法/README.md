# 常微分方程数值解法实现

## 方法分类

### 脚本1：高阶数值解法
1. **经典四阶龙格-库塔法 (RK4)**
2. **显式Adams-Bashforth四阶方法 (AB4)**
3. **隐式梯形法 (Crank-Nicolson)**
4. **辛积分方法 (Verlet算法)**

### 脚本2：基础数值解法
1. **向后欧拉法**
2. **改进欧拉法**
3. **Adams预测校正法**

---

## 方法详解

### 1. 经典四阶龙格-库塔法 (RK4)
#### 计算步骤
```
k₁ = f(tₙ, yₙ)
k₂ = f(tₙ + h/2, yₙ + h/2·k₁)
k₃ = f(tₙ + h/2, yₙ + h/2·k₂)
k₄ = f(tₙ + h, yₙ + h·k₃)
yₙ₊₁ = yₙ + h/6·(k₁ + 2k₂ + 2k₃ + k₄)
```

#### 特性
- **类型**：显式单步法
- **精度**：4阶
- **稳定性**：条件稳定（稳定域中等）
- **适用场景**：非刚性方程
- **计算量**：每步4次函数求值

---

### 2. 显式Adams-Bashforth四阶方法 (AB4)
#### 计算公式
```
yₙ₊₄ = yₙ₊₃ + h/24·(55fₙ₊₃ - 59fₙ₊₂ + 37fₙ₊₁ - 9fₙ)
```

#### 特性
- **类型**：显式多步法
- **精度**：4阶
- **初始化**：需要前4步启动值（通常用RK4生成）
- **存储需求**：需保存前4步的函数值
- **计算量**：每步1次函数求值

---

### 3. 隐式梯形法 (Crank-Nicolson)
#### 计算公式
```
yₙ₊₁ = yₙ + h/2·[f(tₙ, yₙ) + f(tₙ₊₁, yₙ₊₁)]
```

#### 特性
- **类型**：隐式方法
- **精度**：2阶
- **稳定性**：A-稳定（无条件稳定）
- **求解要求**：通常需要牛顿迭代法求解
- **适用场景**：刚性方程

---

### 4. 辛积分方法 (Verlet算法)
#### 计算公式
```
xₙ₊₁ = 2xₙ - xₙ₋₁ + h²·a(xₙ)
vₙ = (xₙ₊₁ - xₙ₋₁)/(2h)
```

#### 特性
- **类型**：显式保结构算法
- **精度**：2阶
- **守恒性**：保持辛结构（能量守恒性好）
- **初始化**：需要x₀和x₁启动
- **典型应用**：分子动力学、天体力学

---

### 5. 向后欧拉法
#### 计算公式
```
yₙ₊₁ = yₙ + h·f(tₙ₊₁, yₙ₊₁)
```

#### 特性
- **类型**：隐式单步法
- **精度**：1阶
- **稳定性**：L-稳定（强阻尼特性）
- **求解要求**：需解非线性方程
- **适用场景**：超刚性方程

---

### 6. 改进欧拉法
#### 计算步骤
```
预测步： y* = yₙ + h·f(tₙ, yₙ)
校正步： yₙ₊₁ = yₙ + h/2·[f(tₙ, yₙ) + f(tₙ₊₁, y*)]
```

#### 特性
- **类型**：预测-校正法
- **精度**：2阶
- **计算量**：每步2次函数求值
- **稳定性**：优于显式欧拉法

---

### 7. Adams预测校正法
#### 计算步骤
```
预测步： yₙ₊₁ᵖ = yₙ + h/2·(3fₙ - fₙ₋₁)
校正步： yₙ₊₁ = yₙ + h/2·[f(tₙ₊₁, yₙ₊₁ᵖ) + f(tₙ, yₙ)]
```

#### 特性
- **类型**：多步预测-校正法
- **精度**：2阶
- **存储需求**：需保存前两步信息
- **计算量**：每步2次函数求值

